
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_example/low_level/plot_initialize.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_example_low_level_plot_initialize.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_example_low_level_plot_initialize.py:


Initialize an FMU with non-default values
=========================================

.. GENERATED FROM PYTHON SOURCE LINES 14-17

The interest of using FMUs in Python lies in the ease to change its input
/ parameter values. This notably enables to study the behavior of the FMU
with uncertain inputs / parameters.

.. GENERATED FROM PYTHON SOURCE LINES 19-23

.. note::
   | A FMU *parameter* remains constant during simulation (a single value).
   | A FMU *input* evolves during simulation (time-dependent values).  
   | See the `FMI Standard <http://shorturl.at/kpJR5>`_ for more details.

.. GENERATED FROM PYTHON SOURCE LINES 25-27

First, retrieve and load the FMU *deviation.fmu*.


.. GENERATED FROM PYTHON SOURCE LINES 27-35

.. code-block:: default

    import otfmi.example.utility
    path_fmu = otfmi.example.utility.get_path_fmu("deviation")
    model = otfmi.fmi.load_fmu(path_fmu)

    # check the beam default length and bending load values
    print(model.get_variable_start("L"))
    print(model.get_variable_start("F"))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    250.0
    30000.0




.. GENERATED FROM PYTHON SOURCE LINES 36-38

We want to set the cantilever beam length to 300 m and the bending load to
25000 N.

.. GENERATED FROM PYTHON SOURCE LINES 40-42

Using inline argument
---------------------

.. GENERATED FROM PYTHON SOURCE LINES 44-45

The beam length can be required directly in the ``simulate`` function:

.. GENERATED FROM PYTHON SOURCE LINES 45-54

.. code-block:: default

    import numpy as np
    result = otfmi.fmi.simulate(model,
        initialization_parameters=[("L", "F"), (300, 25000)])

    # check parameters value and show output value
    print("L = %g" % result.final("L"))  # check parameter value
    print("F = %g" % result.final("F"))  # check parameter value
    print("y = %g" % result.final("y"))  # print output value





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Simulation interval    : 0.0 - 1.0 seconds.
    Elapsed simulation time: 0.012322591999691213 seconds.
    L = 300
    F = 25000
    y = 18.75




.. GENERATED FROM PYTHON SOURCE LINES 55-58

This way of doing is practical when only a few number of parameters / inputs
must be set. For larger numbers of variables to initialize, the use of scripts
is recommended.

.. GENERATED FROM PYTHON SOURCE LINES 60-62

Using initialization scripts
----------------------------

.. GENERATED FROM PYTHON SOURCE LINES 64-68

| Initialization scripts can gather a large number of initial values.
| The use of initialization scripts (*.mos* files) is common in Dymola :
- to save the value of all the variables of a model after simulation,
- to restart simulation from a given point.

.. GENERATED FROM PYTHON SOURCE LINES 70-72

.. note::
   The initialization script can be automatically created in Dymola.

.. GENERATED FROM PYTHON SOURCE LINES 74-75

For clarity, we write the initialization script using Python. 

.. GENERATED FROM PYTHON SOURCE LINES 75-80

.. code-block:: default

    temporary_file = "initialization.mos"
    with open(temporary_file, "w") as f:
        f.write("L = 300;\n")
        f.write("F = 25000;\n")








.. GENERATED FROM PYTHON SOURCE LINES 81-83

Otfmi ``simulate`` function launches FMU initialization, using the
designated script, then simulates the FMU.

.. GENERATED FROM PYTHON SOURCE LINES 83-91

.. code-block:: default

    from os.path import abspath
    result = otfmi.fmi.simulate(
        model, initialization_script=abspath(temporary_file))

    # check parameters value and show output value
    print("L = %g" % result.final("L"))  # check parameter value
    print("F = %g" % result.final("F"))  # check parameter value
    print("y = %g" % result.final("y"))  # print output value




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    Simulation interval    : 0.0 - 1.0 seconds.
    Elapsed simulation time: 0.012744076000672067 seconds.
    L = 300
    F = 25000
    y = 18.75





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.060 seconds)


.. _sphx_glr_download_auto_example_low_level_plot_initialize.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_initialize.py <plot_initialize.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_initialize.ipynb <plot_initialize.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
